# THIS IS AUTOGENERATED. DO NOT EDIT MANUALLY
version = 1
name = "CausalPy"

[setup]
script = '''
#!/usr/bin/env bash
set -euo pipefail

# Ensure conda on PATH (Miniforge)
if ! command -v conda >/dev/null 2>&1; then
  [ -d "$HOME/miniforge3/condabin" ] && export PATH="$HOME/miniforge3/condabin:$PATH"
fi
command -v conda >/dev/null 2>&1 || { echo "conda not found"; exit 1; }

ENV_NAME="CausalPy"

# Create/update shared env (now feasible with Full access)
if ! conda env list | awk '{print $1}' | grep -qx "$ENV_NAME"; then
  echo "[codex] Creating shared env $ENV_NAME"
  conda env create -f environment.yml -n "$ENV_NAME"
else
  echo "[codex] Updating shared env $ENV_NAME"
  conda env update -f environment.yml -n "$ENV_NAME" --prune
fi

# IMPORTANT: do NOT pip install -e . in a shared env across worktrees.
# Instead, rely on the worktree itself for imports:
export PYTHONPATH="$(pwd):${PYTHONPATH:-}"

# Verify
conda run -n "$ENV_NAME" python -V
conda run -n "$ENV_NAME" python -c "import sys; print(sys.executable)"
'''
